% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PH_Calculation.R
\name{process_datasets_PH}
\alias{process_datasets_PH}
\title{PH Pipeline for Single-Cell RNA-Seq Data}
\usage{
process_datasets_PH(
  metadata,
  integration_method = "seurat",
  num_cores = 16,
  MIN_CELLS = 250,
  DIM = 1,
  THRESHOLD = -1,
  dataset_tag = "dataset"
)
}
\arguments{
\item{metadata}{Data frame with file paths and associated metadata.}

\item{integration_method}{Integration method to use ("seurat",
"liger" or "mnn").}

\item{num_cores}{Number of cores for parallel processing.}

\item{MIN_CELLS}{Minimum number of cells to keep a dataset.}

\item{DIM}{Dimensionality for persistent homology calculation.}

\item{THRESHOLD}{Threshold for persistence diagram calculation.}

\item{dataset_tag}{Optional tag appended to output files.}
}
\value{
A list containing processed iterations as well as the detected
  column names for SRA, tissue and approach.
}
\description{
The `process_datasets_PH` function is designed to process single-cell RNA-seq datasets using 
Persistent Homology (PH), data integration techniques, and clustering methods. 
The pipeline handles both integrated and unintegrated data, calculates persistence diagrams, 
and performs statistical comparisons across different clustering methods such as UMAP 
and hierarchical clustering.

Batch effect correction is currently supported through Seurat integration for
multi-sample or multi-dataset workflows.
The final output includes persistence diagrams. Distance matrices
(BDM/SDM/LDM) are produced later during post-processing along with UMAP
embeddings and clustering visualizations.
}
\section{Workflow Overview}{

\enumerate{
  \item \strong{Data Loading & Preprocessing:}
    \itemize{
      \item Loads single-cell RNA-seq data from `.RData` files based on paths in the input metadata.
      \item Creates `Seurat` objects for each sample and filters cells and features based on quality metrics.
      \item Calculates mitochondrial, ribosomal, and hemoglobin gene percentages for quality control.
      \item Normalizes data and identifies variable features for downstream analysis.
    }
  
  \item \strong{Persistent Homology (PH) Analysis:}
    \itemize{
      \item Calculates persistence diagrams for unintegrated data using `ripserr` and `TDA` packages.
      \item Integrates datasets using Seurat and recalculates persistence diagrams for integrated data.
    }
  
  \item \strong{Distance Matrix Generation (Post-Processing):}
    \itemize{
      \item Persistence diagrams created in this step are used by
        `process_iteration_calculate_matrices()` in
        `PH_PostProcessing_andAnalysis.R` to compute BDM, SDM and LDM once.
      \item Downsampling of persistence diagrams may be performed to optimise
        memory usage during these calculations.
    }
  
  \item \strong{Clustering & Visualization:}
    \itemize{
      \item Performs UMAP projections for visualizing data in two-dimensional space.
      \item Conducts hierarchical clustering on UMAP embeddings and compares results with PH-based clusters.
      \item Generates heatmaps, dendrograms, and annotations based on tissue types or experimental conditions.
    }
  
  \item \strong{Statistical Analysis:}
    \itemize{
      \item Performs statistical tests to compare clustering results (e.g., Adjusted Rand Index, Mutual Information, Chi-Square).
      \item Calculates cluster purity, Silhouette analysis, and Davies-Bouldin Index for validating clusters.
    }
}
}

\section{Dependencies}{

The script requires the following R packages:
\code{tidyverse}, \code{Matrix}, \code{ripserr}, \code{TDA}, \code{foreach},
\code{doParallel}, \code{parallel}, \code{rliger}, \code{Seurat}, \code{stringr}, 
\code{ComplexHeatmap}, \code{mclust}, \code{aricode}, \code{clusterSim}, \code{Rtsne}.
}

\section{Usage}{

Ensure all required packages are installed, and the input metadata CSV is correctly formatted with paths to `.RData` files. 
Execute the script in an environment with adequate computational resources, as the pipeline utilizes parallel processing.
}

\section{Example}{

\dontrun{
  # Load metadata and process datasets with Persistent Homology
  metadata <- read.csv("./data/VastlyDifferentTissues/metadata.csv", check.names = FALSE)
  process_datasets_PH(metadata, num_cores = 32)
}
}

\section{Author}{

Jonah Daneshmand
}

\section{License}{
MIT License
}

\examples{
\dontrun{
metadata <- read.csv("./data/VastlyDifferentTissues/metadata.csv", check.names = FALSE)
results <- process_datasets_PH(metadata, num_cores = 32)
}
}
